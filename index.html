<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Conduit Sizing Calculator</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    h2 { margin-top: 30px; }
    table { border-collapse: collapse; width: 100%; margin-bottom: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    select, input[type="number"] { width: 100%; }
    button { padding: 6px 12px; margin-top: 10px; }
    .hidden { display: none; }
  </style>
</head>
<body>

<h1>Automatic Conductor Sizing Calculator</h1>

<label for="usageType">Select Usage:</label>
<select id="usageType" onchange="toggleTables()">
  <option value="electrical">Electrical</option>
  <option value="auxiliary">Auxiliaries</option>
  <option value="both">Both</option>
</select>

<!-- Electrical Table -->
<div id="electricalSection">
  <h2>Electrical Conductors</h2>
  <table id="electricalTable">
    <thead>
      <tr>
        <th># of Conductors</th>
        <th>Wire Size</th>
        <th>Insulation Type</th>
        <th>Calculated Area (in²)</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
  <button onclick="addElectricalRow()">Add Row</button>
</div>

<!-- Auxiliary Table -->
<div id="auxiliarySection" class="hidden">
  <h2>Auxiliary Cables</h2>
  <table id="auxiliaryTable">
    <thead>
      <tr>
        <th># of Conductors</th>
        <th>Type of Cable</th>
        <th>Wire Size</th>
        <th>Calculated Area (in²)</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
  <button onclick="addAuxiliaryRow()">Add Row</button>
</div>

<!-- Conduit Selection -->
<h2>Conduit Type</h2>
<select id="conduitType">
  <option value="EMT">EMT</option>
  <option value="ENT">ENT</option>
  <option value="FMC">FMC</option>
  <option value="IMC">IMC</option>
  <option value="LFNC_A">LFNC_A</option>
  <option value="LFNC_B">LFNC_B</option>
  <option value="LFMC">LFMC</option>
</select>

<script>
const wireSizes = {
  "14 AWG(2.5 mm2)": { THW: 0.0139, THHN: 0.0097, RHW: 0.0293, XHHW: 0.0139 },
  "12AWG(4 mm2)": { THW: 0.0181, THHN: 0.0133, RHW: 0.0353, XHHW: 0.0181 },
  "10AWG(6 mm2)": { THW: 0.0243, THHN: 0.0211, RHW: 0.0437, XHHW: 0.0243 },
  "8AWG(10 mm2)": { THW: 0.0437, THHN: 0.0366, RHW: 0.0835, XHHW: 0.0437 },
  "6AWG(16 mm2)": { THW: 0.0726, THHN: 0.0507, RHW: 0.1041, XHHW: 0.059 },
  "4AWG(25 mm2)": { THW: 0.0973, THHN: 0.0824, RHW: 0.1333, XHHW: 0.0814 },
  "3AWG(35 mm2)": { THW: 0.1134, THHN: 0.0973, RHW: 0.1521, XHHW: 0.0962 }
};

const insulationTypes = ["THW", "THHN", "RHW", "XHHW"];
const wireSizeOptions = Object.keys(wireSizes);

// Toggle between sections
function toggleTables() {
  const type = document.getElementById("usageType").value;
  document.getElementById("electricalSection").classList.toggle("hidden", type === "auxiliary");
  document.getElementById("auxiliarySection").classList.toggle("hidden", type === "electrical");
}

// Add electrical row
function addElectricalRow() {
  const tbody = document.querySelector("#electricalTable tbody");
  const tr = document.createElement("tr");

  tr.innerHTML = `
    <td><input type="number" min="1" value="1" onchange="updateArea(this)"></td>
    <td><select onchange="updateArea(this)">
      ${wireSizeOptions.map(w => `<option value="${w}">${w}</option>`).join('')}
    </select></td>
    <td><select onchange="updateArea(this)">
      ${insulationTypes.map(i => `<option value="${i}">${i}</option>`).join('')}
    </select></td>
    <td class="area">0.0000</td>
    <td><button onclick="removeRow(this)">Delete</button></td>
  `;

  tbody.appendChild(tr);
  updateArea(tr.querySelector("select"));
}

// Add auxiliary row
function addAuxiliaryRow() {
  const tbody = document.querySelector("#auxiliaryTable tbody");
  const tr = document.createElement("tr");

  tr.innerHTML = `
    <td><input type="number" min="1" value="1" onchange="updateArea(this)"></td>
    <td><select><option value="Control">Control</option><option value="Signal">Signal</option></select></td>
    <td><select onchange="updateArea(this)">
      ${wireSizeOptions.map(w => `<option value="${w}">${w}</option>`).join('')}
    </select></td>
    <td class="area">0.0000</td>
    <td><button onclick="removeRow(this)">Delete</button></td>
  `;

  tbody.appendChild(tr);
  updateArea(tr.querySelector("select"));
}

// Remove row
function removeRow(button) {
  button.closest("tr").remove();
}

// Update area
function updateArea(element) {
  const row = element.closest("tr");
  const count = parseInt(row.querySelector("input").value) || 0;
  const wireSize = row.querySelectorAll("select")[0].value;
  const insulation = row.querySelectorAll("select")[1]?.value || "THW"; // default if insulation missing
  const areaCell = row.querySelector(".area");

  const unitArea = wireSizes[wireSize]?.[insulation] || 0;
  areaCell.textContent = (unitArea * count).toFixed(4);
}

// Initialize with one row
addElectricalRow();
addAuxiliaryRow();
</script>

</body>
</html>
