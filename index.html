<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Automatic Conductor and Conduit Sizing Calculator</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f0f4f8;
      padding: 20px;
    }
    h2 {
      color: #2c3e50;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
      background: white;
    }
    th, td {
      padding: 10px;
      text-align: left;
      border: 1px solid #ccc;
    }
    input, select, button {
      padding: 6px;
    }
    #result {
      margin-top: 20px;
      padding: 15px;
      background: #fff9c4;
      border: 1px solid #fbc02d;
      border-radius: 5px;
    }
    button {
      cursor: pointer;
    }
  </style>
</head>
<body>

  <h2>Conductor and Conduit Size Calculator</h2>

  <label for="conduitType">Select Conduit Type:</label>
  <select id="conduitType" onchange="updateTotals()">
    <option value="RMC">RMC</option>
    <!-- Add more conduit types as needed -->
  </select>

  <table id="electricalTable">
    <thead>
      <tr>
        <th>Quantity</th>
        <th>Wire Size</th>
        <th>Insulation Type</th>
        <th>Total Area (in²)</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <button onclick="addElectricalRow()">Add Conductor</button>

  <div id="result"></div>

  <script>
    const wireSizes = {
      "14 AWG(2.5 mm2)": { THW: 0.0139, THHN: 0.0097, RHW: 0.0293, XHHW: 0.0139 },
      "12 AWG(3.5 mm2)": { THW: 0.0206, THHN: 0.0133, RHW: 0.0314, XHHW: 0.0206 },
      "10 AWG(5.5 mm2)": { THW: 0.0333, THHN: 0.0211, RHW: 0.0509, XHHW: 0.0333 },
      "8 AWG(8.0 mm2)": { THW: 0.0531, THHN: 0.0366, RHW: 0.0810, XHHW: 0.0531 },
      "6 AWG(14 mm2)": { THW: 0.0824, THHN: 0.0507, RHW: 0.1227, XHHW: 0.0824 },
      "4 AWG(22 mm2)": { THW: 0.1321, THHN: 0.0824, RHW: 0.1924, XHHW: 0.1321 },
      "2 AWG(38 mm2)": { THW: 0.2143, THHN: 0.1307, RHW: 0.2909, XHHW: 0.2143 },
      "1/0 AWG(53.5 mm2)": { THW: 0.3308, THHN: 0.2067, RHW: 0.4442, XHHW: 0.3308 },
      "3/0 AWG(85 mm2)": { THW: 0.5222, THHN: 0.3278, RHW: 0.6885, XHHW: 0.5222 },
      "250 Kcmill": { THW: 0.7371, THHN: 0.5663, RHW: 0.9318, XHHW: 0.7393 },
      "500 Kcmill": { THW: 1.4375, THHN: 1.1543, RHW: 1.7719, XHHW: 1.4522 },
      "1000 Kcmill": { THW: 1.4784, THHN: 1.3478, RHW: 1.7719, XHHW: 1.3519 }
    };

    const conduitSizes = {
      RMC: [
        { min: 0, max: 0.314, label: '1/2"' },
        { min: 0.315, max: 0.549, label: '3/4"' },
        { min: 0.550, max: 0.887, label: '1"' },
        { min: 0.888, max: 1.526, label: '1-1/4"' },
        { min: 1.527, max: 2.071, label: '1-1/2"' },
        { min: 2.072, max: 3.408, label: '2"' },
        { min: 3.409, max: 4.866, label: '2-1/2"' },
        { min: 4.867, max: 7.499, label: '3"' },
        { min: 7.500, max: 10.010, label: '3-1/2"' },
        { min: 10.011, max: 12.882, label: '4"' },
        { min: 12.883, max: 20.212, label: '5"' },
        { min: 20.213, max: 29.158, label: '6"' }
      ]
    };

    const insulationTypes = ["THW", "THHN", "RHW", "XHHW"];
    const wireSizeOptions = Object.keys(wireSizes);

    function addElectricalRow() {
      const tbody = document.querySelector("#electricalTable tbody");
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td><input type="number" min="1" value="1" onchange="updateArea(this)"></td>
        <td><select onchange="updateArea(this)">
          ${wireSizeOptions.map(w => `<option value="${w}">${w}</option>`).join("")}
        </select></td>
        <td><select onchange="updateArea(this)">
          ${insulationTypes.map(i => `<option value="${i}">${i}</option>`).join("")}
        </select></td>
        <td class="area">0.0000</td>
        <td><button onclick="removeRow(this)">Delete</button></td>
      `;
      tbody.appendChild(tr);
      updateArea(tr.querySelector("input"));
    }

    function removeRow(btn) {
      btn.closest("tr").remove();
      updateTotals();
    }

    function updateArea(el) {
      const row = el.closest("tr");
      const count = parseInt(row.querySelector("input").value) || 0;
      const selects = row.querySelectorAll("select");
      const wireSize = selects[0].value;
      const insulation = selects[1].value;
      const unitArea = wireSizes[wireSize]?.[insulation] || 0;
      const totalArea = count * unitArea;
      row.querySelector(".area").textContent = totalArea.toFixed(4);
      updateTotals();
    }

    function updateTotals() {
      let totalArea = 0;
      let totalConductors = 0;

      document.querySelectorAll("#electricalTable tbody tr").forEach(row => {
        const count = parseInt(row.querySelector("input").value) || 0;
        const area = parseFloat(row.querySelector(".area").textContent) || 0;
        totalConductors += count;
        totalArea += area;
      });

      let fillRatio = totalConductors === 1 ? 0.53 : (totalConductors === 2 ? 0.31 : 0.40);
      const requiredArea = totalArea / fillRatio;

      const conduitType = document.getElementById("conduitType").value;
      const sizes = conduitSizes[conduitType];

      let suggestedSize = "Not available";
      if (sizes && sizes.length > 0) {
        for (let size of sizes) {
          if (requiredArea >= size.min && requiredArea <= size.max) {
            suggestedSize = size.label;
            break;
          }
        }
      }

      document.getElementById("result").innerHTML = `
        <strong>Total Conductors:</strong> ${totalConductors}<br>
        <strong>Total Area of Conductors:</strong> ${totalArea.toFixed(4)} in²<br>
        <strong>NEC Fill %:</strong> ${(fillRatio * 100).toFixed(0)}%<br>
        <strong>Required Area w/ Fill:</strong> ${requiredArea.toFixed(4)} in²<br>
        <strong>Suggested Conduit Size:</strong> ${suggestedSize}
      `;
    }

    // Initialize with one row
    addElectricalRow();
  </script>

</body>
</html>
