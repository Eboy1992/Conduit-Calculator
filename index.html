<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Conduit Size Calculator</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    select, input { margin: 5px; padding: 5px; }
    table { border-collapse: collapse; width: 100%; margin-top: 10px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background-color: #f0f0f0; }
    .hidden { display: none; }
    .summary-box {
      background: #cfe2f3;
      padding: 15px;
      margin-top: 20px;
      border: 2px solid #000;
      text-align: center;
    }
    .add-button {
      margin-top: 10px;
      padding: 8px 16px;
      background-color: #4CAF50;
      color: white;
      border: none;
      cursor: pointer;
    }
  </style>
</head>
<body>

  <h2>Conduit Size Calculator</h2>

  <label>Calculator Type:
    <select id="calcType" onchange="toggleTables()">
      <option value="electrical">Electrical</option>
      <option value="auxiliary">Auxiliary</option>
      <option value="both">Both</option>
    </select>
  </label>

  <div id="electricalTable">
    <h3>Electrical Conductors</h3>
    <table>
      <thead>
        <tr><th>No. of Conductors</th><th>Size</th><th>Type</th><th>Area</th></tr>
      </thead>
      <tbody id="electricalBody">
      </tbody>
    </table>
    <button class="add-button" onclick="addElectricalRow()">Add Electrical Row</button>
  </div>

  <div id="auxiliaryTable" class="hidden">
    <h3>Auxiliary Cables</h3>
    <table>
      <thead>
        <tr><th>No. of Cables</th><th>Type</th><th>Size</th><th>Area</th></tr>
      </thead>
      <tbody id="auxBody">
      </tbody>
    </table>
    <button class="add-button" onclick="addAuxRow()">Add Auxiliary Row</button>
  </div>

  <div class="summary-box">
    <div><strong>Total Area:</strong> <span id="totalArea">0</span></div>
    <div><strong>Conduit Type:</strong>
      <select id="conduitType">
        <option value="EMT">EMT</option>
        <option value="ENT">ENT</option>
        <option value="FMC">FMC</option>
        <option value="IMC">IMC</option>
        <option value="LFNC_A">LFNC_A</option>
        <option value="LFNC_B">LFNC_B</option>
        <option value="LFMC">LFMC</option>
        <option value="RMC">RMC</option>
        <option value="PVC40">PVC40</option>
        <option value="PVC80">PVC80</option>
      </select>
    </div>
    <div><strong>Minimum Conduit Size:</strong> <span id="minSize">--</span></div>
  </div>

  <script>
    const areaLookup = {
      '14 AWG(2.5 mm2)': 0.0130,
      '12AWG(4 mm2)': 0.0201,
      '10AWG(6 mm2)': 0.0314,
      '8AWG(10 mm2)': 0.0456,
      '6AWG(16 mm2)': 0.0658,
      '4AWG(25 mm2)': 0.0824,
      '3AWG(35 mm2)': 0.0974,
      '2AWG(35 mm2)': 0.1158,
      '1AWG(50 mm2)': 0.1341,
      '1/0AWG(55 mm2)': 0.1707,
      '2/0AWG(70 mm2)': 0.1963,
      '3/0AWG(95 mm2)': 0.2271,
      '4/0AWG(120 mm2)': 0.2604,
      '250 Kcmill': 0.3160,
      '300 Kcmill': 0.3550,
      '350 Kcmill': 0.3950,
      '400 Kcmill': 0.4360,
      '500 Kcmill': 0.4840,
      '600 Kcmill': 0.5590,
      '700 Kcmill': 0.6080,
      '750 Kcmill': 0.6300,
      '800 Kcmill': 0.6520,
      '900 Kcmill': 0.6980,
      '1000 Kcmill': 0.7400,
      'Fiber-2f': 0.0200,
      'Fiber-4f': 0.0300,
      'Fiber-6f': 0.0400,
      'Fiber-8f': 0.0500,
      'Fiber-12f': 0.0600,
      'Fiber-24f': 0.0800,
      'Fiber-36f': 0.1000,
      'Fiber-48f': 0.1200,
      'Fiber-72f': 0.1600,
      'Fiber-96f': 0.2000,
      'Fiber-144f': 0.2400
    };

    function toggleTables() {
      const type = document.getElementById('calcType').value;
      document.getElementById('electricalTable').classList.toggle('hidden', type === 'auxiliary');
      document.getElementById('auxiliaryTable').classList.toggle('hidden', type === 'electrical');
      calculateTotal();
    }

    function calculateTotal() {
      let total = 0;

      document.querySelectorAll('#electricalTable tbody tr').forEach(row => {
        const qty = parseInt(row.cells[0].querySelector('input').value) || 0;
        const size = row.cells[1].querySelector('select').value;
        const key = size;
        const area = areaLookup[key] || 0;
        const rowArea = qty * area;
        row.cells[3].textContent = rowArea.toFixed(4);
        total += rowArea;
      });

      document.querySelectorAll('#auxiliaryTable tbody tr').forEach(row => {
        const qty = parseInt(row.cells[0].querySelector('input').value) || 0;
        const type = row.cells[1].querySelector('select').value;
        const size = row.cells[2].querySelector('select').value;
        const key = `${type}-${size}`;
        const area = areaLookup[key] || 0;
        const rowArea = qty * area;
        row.cells[3].textContent = rowArea.toFixed(4);
        total += rowArea;
      });

      document.getElementById('totalArea').textContent = total.toFixed(3);

      const minSize = (total <= 2.0) ? '1"' : (total <= 3.5 ? '2"' : (total <= 6.0 ? '3"' : '5"'));
      document.getElementById('minSize').textContent = minSize;
    }

    function addElectricalRow() {
      const row = document.createElement('tr');
      row.innerHTML = `
        <td><input type="number" value="1" onchange="calculateTotal()"></td>
        <td>
          <select onchange="calculateTotal()">
            ${Object.keys(areaLookup).filter(k => !k.includes('Fiber')).map(k => `<option>${k}</option>`).join('')}
          </select>
        </td>
        <td>
          <select onchange="calculateTotal()">
            <option value="THHN">THHN</option>
            <option value="THW">THW</option>
          </select>
        </td>
        <td class="area">0</td>
      `;
      document.getElementById('electricalBody').appendChild(row);
      calculateTotal();
    }

    function addAuxRow() {
      const row = document.createElement('tr');
      row.innerHTML = `
        <td><input type="number" value="1" onchange="calculateTotal()"></td>
        <td>
          <select onchange="calculateTotal()">
            <option value="Fiber">Fiber</option>
            <option value="LV">LV</option>
          </select>
        </td>
        <td>
          <select onchange="calculateTotal()">
            ${["2f","4f","6f","8f","12f","24f","36f","48f","72f","96f","144f"].map(size => `<option>${size}</option>`).join('')}
          </select>
        </td>
        <td class="area">0</td>
      `;
      document.getElementById('auxBody').appendChild(row);
      calculateTotal();
    }

    window.onload = () => {
      addElectricalRow();
      addAuxRow();
      toggleTables();
    };
  </script>
</body>
</html>
