<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Conduit Sizing Calculator</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f0f4f8; padding: 20px; }
    h2 { color: #2c3e50; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background-color: #e1eaf1; }
    select, input { width: 100%; padding: 5px; }
    #output { margin-top: 20px; font-weight: bold; }
  </style>
</head>
<body>

<h2>Automatic Conduit Sizing Calculator</h2>

<table id="conductorTable">
  <thead>
    <tr>
      <th>Wire Size</th>
      <th>Insulation Type</th>
      <th>Quantity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <select class="wire-size">
          <option>14 AWG(2.5 mm2)</option>
          <option>12AWG(4 mm2)</option>
          <option>10AWG(6 mm2)</option>
          <option>8AWG(10 mm2)</option>
          <option>6AWG(16 mm2)</option>
          <option>4AWG(25 mm2)</option>
          <option>3AWG(35 mm2)</option>
          <option>2AWG(35 mm2)</option>
          <option>1AWG(50 mm2)</option>
          <option>1/0AWG(55 mm2)</option>
          <option>2/0AWG(70 mm2)</option>
          <option>3/0AWG(95 mm2)</option>
          <option>4/0AWG(120 mm2)</option>
          <option>250 Kcmill</option>
          <option>300 Kcmill</option>
          <option>350 Kcmill</option>
          <option>400 Kcmill</option>
          <option>500 Kcmill</option>
          <option>600 Kcmill</option>
          <option>700 Kcmill</option>
          <option>750 Kcmill</option>
          <option>800 Kcmill</option>
          <option>900 Kcmill</option>
          <option>1000 Kcmill</option>
        </select>
      </td>
      <td>
        <select class="insulation-type">
          <option>THW</option>
          <option>THHN</option>
          <option>RHW</option>
          <option>XHHW</option>
        </select>
      </td>
      <td><input type="number" class="quantity" value="1" min="0" onchange="updateTotals()"></td>
    </tr>
  </tbody>
</table>

<button onclick="addRow()">Add Row</button>

<div id="output">
  <p id="totalArea">Total Area: </p>
  <p id="minConduit">Minimum RMC Conduit Size: </p>
</div>

<script>
const wireSizes = {
  "14 AWG(2.5 mm2)": { THW: 0.0139, THHN: 0.0097, RHW: 0.0293, XHHW: 0.0139 },
  "12AWG(4 mm2)": { THW: 0.0181, THHN: 0.0133, RHW: 0.0353, XHHW: 0.0181 },
  "10AWG(6 mm2)": { THW: 0.0243, THHN: 0.0211, RHW: 0.0437, XHHW: 0.0243 },
  "8AWG(10 mm2)": { THW: 0.0437, THHN: 0.0366, RHW: 0.0835, XHHW: 0.0437 },
  "6AWG(16 mm2)": { THW: 0.0726, THHN: 0.0507, RHW: 0.1041, XHHW: 0.0590 },
  "4AWG(25 mm2)": { THW: 0.0973, THHN: 0.0824, RHW: 0.1333, XHHW: 0.0814 },
  "3AWG(35 mm2)": { THW: 0.1134, THHN: 0.0973, RHW: 0.1521, XHHW: 0.0962 },
  "2AWG(35 mm2)": { THW: 0.1333, THHN: 0.1158, RHW: 0.1750, XHHW: 0.1146 },
  "1AWG(50 mm2)": { THW: 0.1901, THHN: 0.1562, RHW: 0.2660, XHHW: 0.1534 },
  "1/0AWG(55 mm2)": { THW: 0.2223, THHN: 0.1855, RHW: 0.3039, XHHW: 0.1825 },
  "2/0AWG(70 mm2)": { THW: 0.2624, THHN: 0.2223, RHW: 0.3505, XHHW: 0.2190 },
  "3/0AWG(95 mm2)": { THW: 0.3117, THHN: 0.2679, RHW: 0.4072, XHHW: 0.2642 },
  "4/0AWG(120 mm2)": { THW: 0.3718, THHN: 0.3237, RHW: 0.4754, XHHW: 0.3197 },
  "250 Kcmill": { THW: 0.4596, THHN: 0.3970, RHW: 0.6291, XHHW: 0.3904 },
  "300 Kcmill": { THW: 0.5281, THHN: 0.4608, RHW: 0.7088, XHHW: 0.4536 },
  "350 Kcmill": { THW: 0.5958, THHN: 0.5242, RHW: 0.7870, XHHW: 0.5166 },
  "400 Kcmill": { THW: 0.6619, THHN: 0.5863, RHW: 0.8626, XHHW: 0.5782 },
  "500 Kcmill": { THW: 0.7901, THHN: 0.7073, RHW: 1.0082, XHHW: 0.6984 },
  "600 Kcmill": { THW: 0.9729, THHN: 0.8676, RHW: 1.2135, XHHW: 0.8709 },
  "700 Kcmill": { THW: 1.1010, THHN: 0.9887, RHW: 1.3561, XHHW: 0.9923 },
  "750 Kcmill": { THW: 1.1652, THHN: 1.0496, RHW: 1.4272, XHHW: 1.0532 },
  "800 Kcmill": { THW: 1.2272, THHN: 1.1085, RHW: 1.4957, XHHW: 1.1122 },
  "900 Kcmill": { THW: 1.3561, THHN: 1.2311, RHW: 1.6377, XHHW: 1.2351 },
  "1000 Kcmill": { THW: 1.4784, THHN: 1.3478, RHW: 1.7719, XHHW: 1.3519 }
};

function computeMinConduitSize(totalArea) {
  const rmcTable = [
    { min: 0, max: 0.314, size: '1/2"' },
    { min: 0.315, max: 0.549, size: '3/4"' },
    { min: 0.550, max: 0.887, size: '1"' },
    { min: 0.888, max: 1.526, size: '1-1/4"' },
    { min: 1.527, max: 2.071, size: '1-1/2"' },
    { min: 2.072, max: 3.408, size: '2"' },
    { min: 3.409, max: 4.866, size: '2-1/2"' },
    { min: 4.867, max: 7.499, size: '3"' },
    { min: 7.500, max: 10.010, size: '3-1/2"' },
    { min: 10.011, max: 12.882, size: '4"' },
    { min: 12.883, max: 20.212, size: '5"' },
    { min: 20.213, max: 29.158, size: '6"' },
    { min: 29.159, max: Infinity, size: 'N/A' }
  ];
  for (const r of rmcTable) {
    if (totalArea >= r.min && totalArea <= r.max) return r.size;
  }
  return 'N/A';
}

function updateTotals() {
  const rows = document.querySelectorAll("#conductorTable tbody tr");
  let totalArea = 0;

  rows.forEach(row => {
    const wire = row.querySelector(".wire-size").value;
    const insulation = row.querySelector(".insulation-type").value;
    const qty = parseInt(row.querySelector(".quantity").value) || 0;
    const area = wireSizes[wire]?.[insulation] || 0;
    totalArea += area * qty;
  });

  const fillLimit = 0.4;
  const adjustedArea = totalArea / fillLimit;
  const minSize = computeMinConduitSize(adjustedArea);

  document.getElementById("totalArea").textContent = `Total Area: ${totalArea.toFixed(4)} inÂ²`;
  document.getElementById("minConduit").textContent = `Minimum RMC Conduit Size: ${minSize}`;
}

function addRow() {
  const table = document.querySelector("#conductorTable tbody");
  const newRow = table.rows[0].cloneNode(true);
  newRow.querySelector(".quantity").value = 1;
  newRow.querySelectorAll("select").forEach(sel => sel.selectedIndex = 0);
  table.appendChild(newRow);
}
</script>

</body>
</html>
