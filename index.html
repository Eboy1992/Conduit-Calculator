<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Automatic Conductor Sizing Calculator</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f0f4f8;
      padding: 20px;
    }

    h2, h3 {
      color: #003366;
    }

    table {
      border-collapse: collapse;
      width: 100%;
      margin-bottom: 10px;
    }

    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center;
    }

    th {
      background-color: #002b45;
      color: white;
    }

    #electricalTable tbody tr {
      background-color: #fffbe6;
    }

    input[type="number"], select {
      width: 100%;
      padding: 4px;
    }

    button {
      padding: 6px 12px;
      margin: 5px 0;
      background-color: #003366;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }

    button:hover {
      background-color: #0059b3;
    }

    .hidden {
      display: none;
    }

    #result {
      background: #ffffff;
      border: 1px solid #003366;
      padding: 12px;
      font-size: 1rem;
    }
  </style>
</head>
<body>

<h2>Automatic Conductor Sizing Calculator</h2>

<!-- Electrical Table Only -->
<h3>âš¡ Electrical</h3>
<table id="electricalTable">
  <thead>
    <tr>
      <th>Number of Conductors</th>
      <th>Size of Conductor</th>
      <th>Type of Insulation</th>
      <th>Calculated Area (inÂ²)</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>
<button onclick="addElectricalRow()">Add Electrical Row</button>

<!-- Conduit Type -->
<h3>ðŸ“¦ Conduit Selection</h3>
<label for="conduitType"><strong>Conduit Type:</strong></label>
<select id="conduitType" onchange="updateTotals()">
  <option value="EMT">EMT</option>
  <option value="ENT">ENT</option>
  <option value="FMC">FMC</option>
  <option value="IMC">IMC</option>
  <option value="LFNC_A">LFNC_A</option>
  <option value="LFNC_B">LFNC_B</option>
  <option value="LFMC">LFMC</option>
  <option value="RMC">RMC</option>
  <option value="PVC40">PVC40</option>
  <option value="PVC80">PVC80</option>
</select>

<!-- Result -->
<div id="result"></div>

<script>
const wireSizes = {
  "14 AWG(2.5 mm2)": { THW: 0.0139, THHN: 0.0097, RHW: 0.0293, XHHW: 0.0139 },
  "12AWG(4 mm2)": { THW: 0.0181, THHN: 0.0133, RHW: 0.0353, XHHW: 0.0181 },
  "10AWG(6 mm2)": { THW: 0.0243, THHN: 0.0211, RHW: 0.0437, XHHW: 0.0243 },
  "8AWG(10 mm2)": { THW: 0.0437, THHN: 0.0366, RHW: 0.0835, XHHW: 0.0437 },
  "6AWG(16 mm2)": { THW: 0.0726, THHN: 0.0507, RHW: 0.1041, XHHW: 0.0590 },
  "4AWG(25 mm2)": { THW: 0.0973, THHN: 0.0824, RHW: 0.1333, XHHW: 0.0814 },
  "3AWG(35 mm2)": { THW: 0.1134, THHN: 0.0973, RHW: 0.1521, XHHW: 0.0962 },
  "2AWG(35 mm2)": { THW: 0.1333, THHN: 0.1158, RHW: 0.1750, XHHW: 0.1146 },
  "1AWG(50 mm2)": { THW: 0.1901, THHN: 0.1562, RHW: 0.2660, XHHW: 0.1534 },
  "1/0AWG(55 mm2)": { THW: 0.2223, THHN: 0.1855, RHW: 0.3039, XHHW: 0.1825 },
  "2/0AWG(70 mm2)": { THW: 0.2624, THHN: 0.2223, RHW: 0.3505, XHHW: 0.2190 },
  "3/0AWG(95 mm2)": { THW: 0.3117, THHN: 0.2679, RHW: 0.4072, XHHW: 0.2642 },
  "4/0AWG(120 mm2)": { THW: 0.3718, THHN: 0.3237, RHW: 0.4754, XHHW: 0.3197 },
  "250 Kcmill": { THW: 0.4596, THHN: 0.3970, RHW: 0.6291, XHHW: 0.3904 },
  "300 Kcmill": { THW: 0.5281, THHN: 0.4608, RHW: 0.7088, XHHW: 0.4536 },
  "350 Kcmill": { THW: 0.5958, THHN: 0.5242, RHW: 0.7870, XHHW: 0.5166 },
  "400 Kcmill": { THW: 0.6619, THHN: 0.5863, RHW: 0.8626, XHHW: 0.5782 },
  "500 Kcmill": { THW: 0.7901, THHN: 0.7073, RHW: 1.0082, XHHW: 0.6984 },
  "600 Kcmill": { THW: 0.9729, THHN: 0.8676, RHW: 1.2135, XHHW: 0.8709 },
  "700 Kcmill": { THW: 1.1010, THHN: 0.9887, RHW: 1.3561, XHHW: 0.9923 },
  "750 Kcmill": { THW: 1.1652, THHN: 1.0496, RHW: 1.4272, XHHW: 1.0532 },
  "800 Kcmill": { THW: 1.2272, THHN: 1.1085, RHW: 1.4957, XHHW: 1.1122 },
  "900 Kcmill": { THW: 1.3561, THHN: 1.2311, RHW: 1.6377, XHHW: 1.2351 },
  "1000 Kcmill": { THW: 1.4784, THHN: 1.3478, RHW: 1.7719, XHHW: 1.3519 }
};

const conduitSizes = {
  EMT: [0.304, 0.533, 0.864, 1.496, 2.036, 3.356, 5.858, 8.846, 11.545, 14.753],
  ENT: [0.122, 0.213, 0.346, 0.598, 0.814, 1.087],
  FMC: [0.122, 0.213, 0.346, 0.598],
  IMC: [0.122, 0.213, 0.346, 0.598, 0.814, 1.087, 1.296],
  LFNC_A: [0.122, 0.213, 0.346],
  LFNC_B: [0.122, 0.213, 0.346],
  LFMC: [0.122, 0.213, 0.346],
  RMC: [0.314, 0.549, 0.887, 1.526, 2.071, 3.408, 4.866, 7.499, 10.010, 12.882, 20.212, 29.158],
  PVC40: [0.122, 0.213, 0.346, 0.598, 0.814, 1.087],
  PVC80: [0.122, 0.213, 0.346, 0.598, 0.814, 1.087]
};

const rmcTradeSizes = [
  '1/2"', '3/4"', '1"', '1-1/4"', '1-1/2"', '2"', '2-1/2"', '3"', '3-1/2"', '4"', '5"', '6"'
];
const emtTradeSizes = [
  '1/2"', '3/4"', '1"', '1-1/4"', '1-1/2"', '2"', '2-1/2"', '3"', '3-1/2"', '4"'
];

const insulationTypes = ["THW", "THHN", "RHW", "XHHW"];
const wireSizeOptions = Object.keys(wireSizes);

function addElectricalRow() {
  const tbody = document.querySelector("#electricalTable tbody");
  const tr = document.createElement("tr");
  tr.innerHTML = `
    <td><input type="number" min="1" value="1" onchange="updateArea(this)"></td>
    <td><select onchange="updateArea(this)">
      ${wireSizeOptions.map(w => `<option value="${w}">${w}</option>`).join("")}
    </select></td>
    <td><select onchange="updateArea(this)">
      ${insulationTypes.map(i => `<option value="${i}">${i}</option>`).join("")}
    </select></td>
    <td class="area">0.0000</td>
    <td><button onclick="removeRow(this)">Delete</button></td>
  `;
  tbody.appendChild(tr);
  updateArea(tr.querySelector("select"));
}

function removeRow(btn) {
  btn.closest("tr").remove();
  updateTotals();
}

function updateArea(el) {
  const row = el.closest("tr");
  const count = parseInt(row.querySelector("input").value) || 0;
  const selects = row.querySelectorAll("select");
  const wireSize = selects[0].value;
  const insulation = selects[1].value;
  const unitArea = wireSizes[wireSize]?.[insulation] || 0;
  const totalArea = count * unitArea;
  row.querySelector(".area").textContent = totalArea.toFixed(4);
  updateTotals();
}

function updateTotals() {
  let totalArea = 0;
  let totalConductors = 0;

  document.querySelectorAll("#electricalTable tbody tr").forEach(row => {
    const count = parseInt(row.querySelector("input").value) || 0;
    const area = parseFloat(row.querySelector(".area").textContent) || 0;
    totalConductors += count;
    totalArea += area;
  });

  let fillRatio = totalConductors === 1 ? 0.53 : (totalConductors === 2 ? 0.31 : 0.40);
  const requiredArea = totalArea / fillRatio;
  const conduitType = document.getElementById("conduitType").value;
  const sizes = conduitSizes[conduitType] || [];

  let suggestedSize = "Not available";
  for (let i = 0; i < sizes.length; i++) {
    if (sizes[i] >= requiredArea) {
      if (conduitType === "RMC") {
        suggestedSize = `${rmcTradeSizes[i]} RMC (Max Fill ${sizes[i].toFixed(3)} inÂ²)`;
      }
      if (conduitType === "EMT") {
        suggestedSize = `${emtTradeSizes[i]} EMT (Max Fill ${sizes[i].toFixed(3)} inÂ²)`;
      } else {
        suggestedSize = `Trade Size ${i + 1} ${conduitType} (Max Fill ${sizes[i].toFixed(3)} inÂ²)`;
      }
      break;
    }
  }

  document.getElementById("result").innerHTML = `
    <strong>Total Conductors:</strong> ${totalConductors}<br>
    <strong>Total Area of Conductors:</strong> ${totalArea.toFixed(4)} inÂ²<br>
    <strong>NEC Fill %:</strong> ${(fillRatio * 100).toFixed(0)}%<br>
    <strong>Required Area w/ Fill:</strong> ${requiredArea.toFixed(4)} inÂ²<br>
    <strong>Suggested Conduit Size:</strong> ${suggestedSize}
  `;
}

addElectricalRow();
</script>
</script>
</body>
</html>
