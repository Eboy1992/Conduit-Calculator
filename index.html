<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Automatic Conductor Sizing Calculator</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f0f4f8;
      padding: 20px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 1rem;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
    }
    th {
      background: #dfe6e9;
    }
    input, select {
      width: 100%;
    }
    #addRow {
      margin: 10px 0;
    }
    .result {
      margin-top: 20px;
      font-weight: bold;
    }
  </style>
</head>
<body>

<h2>Conductor and Conduit Size Calculator</h2>

<table id="conductorTable">
  <thead>
    <tr>
      <th>Wire Size</th>
      <th>Insulation Type</th>
      <th>Quantity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <select class="wire-size">
          <option value="14 AWG(2.5 mm2)">14 AWG(2.5 mm2)</option>
          <option value="12AWG(4 mm2)">12AWG(4 mm2)</option>
          <option value="10AWG(6 mm2)">10AWG(6 mm2)</option>
          <option value="8AWG(10 mm2)">8AWG(10 mm2)</option>
          <option value="6AWG(16 mm2)">6AWG(16 mm2)</option>
          <option value="4AWG(25 mm2)">4AWG(25 mm2)</option>
          <option value="3AWG(35 mm2)">3AWG(35 mm2)</option>
          <option value="2AWG(35 mm2)">2AWG(35 mm2)</option>
          <option value="1AWG(50 mm2)">1AWG(50 mm2)</option>
          <option value="1/0AWG(55 mm2)">1/0AWG(55 mm2)</option>
          <option value="2/0AWG(70 mm2)">2/0AWG(70 mm2)</option>
          <option value="3/0AWG(95 mm2)">3/0AWG(95 mm2)</option>
          <option value="4/0AWG(120 mm2)">4/0AWG(120 mm2)</option>
          <option value="250 Kcmill">250 Kcmill</option>
          <option value="300 Kcmill">300 Kcmill</option>
          <option value="350 Kcmill">350 Kcmill</option>
          <option value="400 Kcmill">400 Kcmill</option>
          <option value="500 Kcmill">500 Kcmill</option>
          <option value="600 Kcmill">600 Kcmill</option>
          <option value="700 Kcmill">700 Kcmill</option>
          <option value="750 Kcmill">750 Kcmill</option>
          <option value="800 Kcmill">800 Kcmill</option>
          <option value="900 Kcmill">900 Kcmill</option>
          <option value="1000 Kcmill">1000 Kcmill</option>
        </select>
      </td>
      <td>
        <select class="insulation-type">
          <option value="THW">THW</option>
          <option value="THHN">THHN</option>
          <option value="RHW">RHW</option>
          <option value="XHHW">XHHW</option>
        </select>
      </td>
      <td><input type="number" class="quantity" value="1" min="1"></td>
    </tr>
  </tbody>
</table>

<button id="addRow">Add Row</button>
<select id="conduitType">
  <option value="RMC">RMC</option>
  <option value="EMT">EMT</option>
  <option value="PVC40">PVC40</option>
</select>
<button onclick="updateTotals()">Calculate Minimum Conduit Size</button>

<div class="result" id="totalArea">Total Area: </div>
<div class="result" id="minConduit">Minimum Conduit Size: </div>

<script>
const wireSizes = {
  "14 AWG(2.5 mm2)": { THW: 0.0139, THHN: 0.0097, RHW: 0.0293, XHHW: 0.0139 },
  "12AWG(4 mm2)": { THW: 0.0181, THHN: 0.0133, RHW: 0.0353, XHHW: 0.0181 },
  "10AWG(6 mm2)": { THW: 0.0243, THHN: 0.0211, RHW: 0.0437, XHHW: 0.0243 },
  "8AWG(10 mm2)": { THW: 0.0437, THHN: 0.0366, RHW: 0.0835, XHHW: 0.0437 },
  "6AWG(16 mm2)": { THW: 0.0726, THHN: 0.0507, RHW: 0.1041, XHHW: 0.0590 },
  "4AWG(25 mm2)": { THW: 0.0973, THHN: 0.0824, RHW: 0.1333, XHHW: 0.0814 },
  "3AWG(35 mm2)": { THW: 0.1134, THHN: 0.0973, RHW: 0.1521, XHHW: 0.0962 },
  "2AWG(35 mm2)": { THW: 0.1333, THHN: 0.1158, RHW: 0.1750, XHHW: 0.1146 },
  "1AWG(50 mm2)": { THW: 0.1901, THHN: 0.1562, RHW: 0.2660, XHHW: 0.1534 },
  "1/0AWG(55 mm2)": { THW: 0.2223, THHN: 0.1855, RHW: 0.3039, XHHW: 0.1825 },
  "2/0AWG(70 mm2)": { THW: 0.2624, THHN: 0.2223, RHW: 0.3505, XHHW: 0.2190 },
  "3/0AWG(95 mm2)": { THW: 0.3117, THHN: 0.2679, RHW: 0.4072, XHHW: 0.2642 },
  "4/0AWG(120 mm2)": { THW: 0.3718, THHN: 0.3237, RHW: 0.4754, XHHW: 0.3197 },
  "250 Kcmill": { THW: 0.4596, THHN: 0.3970, RHW: 0.6291, XHHW: 0.3904 },
  "300 Kcmill": { THW: 0.5281, THHN: 0.4608, RHW: 0.7088, XHHW: 0.4536 },
  "350 Kcmill": { THW: 0.5958, THHN: 0.5242, RHW: 0.7870, XHHW: 0.5166 },
  "400 Kcmill": { THW: 0.6619, THHN: 0.5863, RHW: 0.8626, XHHW: 0.5782 },
  "500 Kcmill": { THW: 0.7901, THHN: 0.7073, RHW: 1.0082, XHHW: 0.6984 },
  "600 Kcmill": { THW: 0.9729, THHN: 0.8676, RHW: 1.2135, XHHW: 0.8709 },
  "700 Kcmill": { THW: 1.1010, THHN: 0.9887, RHW: 1.3561, XHHW: 0.9923 },
  "750 Kcmill": { THW: 1.1652, THHN: 1.0496, RHW: 1.4272, XHHW: 1.0532 },
  "800 Kcmill": { THW: 1.2272, THHN: 1.1085, RHW: 1.4957, XHHW: 1.1122 },
  "900 Kcmill": { THW: 1.3561, THHN: 1.2311, RHW: 1.6377, XHHW: 1.2351 },
  "1000 Kcmill": { THW: 1.4784, THHN: 1.3478, RHW: 1.7719, XHHW: 1.3519 }
};

const conduitSizes = {
  EMT: [0.122, 0.213, 0.346, 0.598, 0.814, 1.087, 1.296, 1.533, 2.036],
  ENT: [0.122, 0.213, 0.346, 0.598, 0.814, 1.087],
  FMC: [0.122, 0.213, 0.346, 0.598],
  IMC: [0.122, 0.213, 0.346, 0.598, 0.814, 1.087, 1.296],
  LFNC_A: [0.122, 0.213, 0.346],
  LFNC_B: [0.122, 0.213, 0.346],
  LFMC: [0.122, 0.213, 0.346],
  RMC: [0.122, 0.213, 0.346, 0.598, 0.814],
  PVC40: [0.122, 0.213, 0.346, 0.598, 0.814, 1.087],
  PVC80: [0.122, 0.213, 0.346, 0.598, 0.814, 1.087]
};

function updateTotals() {
  const rows = document.querySelectorAll("#conductorTable tbody tr");
  let totalArea = 0;

  rows.forEach(row => {
    const wire = row.querySelector(".wire-size").value;
    const insulation = row.querySelector(".insulation-type").value;
    const qty = parseInt(row.querySelector(".quantity").value) || 0;
    const area = wireSizes[wire]?.[insulation] || 0;
    totalArea += area * qty;
  });

  const conduitType = document.getElementById("conduitType").value;
  const sizes = conduitSizes[conduitType];
  const fillLimit = 0.4; // 40% max fill

  let minSize = sizes.find(size => size * fillLimit >= totalArea);
  document.getElementById("totalArea").textContent = `Total Area: ${totalArea.toFixed(4)} in²`;
  document.getElementById("minConduit").textContent = minSize
    ? `Minimum Conduit Size: ${minSize.toFixed(3)} in²`
    : "No suitable conduit size found.";
}

document.getElementById("addRow").addEventListener("click", () => {
  const table = document.querySelector("#conductorTable tbody");
  const newRow = table.rows[0].cloneNode(true);
  newRow.querySelector(".quantity").value = 1;
  table.appendChild(newRow);
});
</script>

</body>
</html>
